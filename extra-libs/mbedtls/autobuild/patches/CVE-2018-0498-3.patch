From 6a25cfae2a7bf34f206232168942bd2db0886742 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Manuel=20P=C3=A9gouri=C3=A9-Gonnard?=
 <manuel.pegourie-gonnard@arm.com>
Date: Tue, 10 Jul 2018 11:15:36 +0200
Subject: [PATCH] Avoid debug message that might leak length

The length to the debug message could conceivably leak through the time it
takes to print it, and that length would in turn reveal whether padding was
correct or not.
---
 library/ssl_tls.c | 2 ++
 1 file changed, 2 insertions(+)

--- a/library/ssl_tls.c
+++ b/library/ssl_tls.c
@@ -1937,8 +1937,10 @@ static int ssl_decrypt_buf( mbedtls_ssl_
         return( MBEDTLS_ERR_SSL_INTERNAL_ERROR );
     }
 
+#if defined(MBEDTLS_SSL_DEBUG_ALL)
     MBEDTLS_SSL_DEBUG_BUF( 4, "raw buffer after decryption",
                    ssl->in_msg, ssl->in_msglen );
+#endif
 
     /*
      * Authenticate if not done yet.
