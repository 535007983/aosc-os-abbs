From 0db77f7b02e013c8e5f9de617a1a46e95f2a6c40 Mon Sep 17 00:00:00 2001
From: Arno Messiaen <arnomessiaen@gmail.com>
Date: Sun, 29 Sep 2019 23:21:39 +0200
Subject: [PATCH 01/51] lima: fix stride in texture descriptor

Signed-off-by: Arno Messiaen <arnomessiaen@gmail.com>
Reviewed-by: Vasily Khoruzhick <anarsoul@gmail.com>
Reviewed-by: Erico Nunes <nunes.erico@gmail.com>
---
 src/gallium/drivers/lima/lima_texture.c | 2 +-
 src/gallium/drivers/lima/lima_texture.h | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/src/gallium/drivers/lima/lima_texture.c b/src/gallium/drivers/lima/lima_texture.c
index a259a1c7b7a..b25d84ec20f 100644
--- a/src/gallium/drivers/lima/lima_texture.c
+++ b/src/gallium/drivers/lima/lima_texture.c
@@ -89,7 +89,7 @@ lima_texture_desc_set_res(struct lima_context *ctx, lima_tex_desc *desc,
    else {
       /* for padded linear texture */
       if (lima_res->levels[first_level].width != width) {
-         desc->stride = lima_res->levels[first_level].width;
+         desc->stride = lima_res->levels[first_level].stride;
          desc->has_stride = 1;
       }
       layout = 0;
diff --git a/src/gallium/drivers/lima/lima_texture.h b/src/gallium/drivers/lima/lima_texture.h
index 82e65df70de..e9b896763ea 100644
--- a/src/gallium/drivers/lima/lima_texture.h
+++ b/src/gallium/drivers/lima/lima_texture.h
@@ -32,8 +32,8 @@ typedef struct __attribute__((__packed__)) {
    uint32_t format : 6;
    uint32_t flag1: 1;
    uint32_t swap_r_b: 1;
-   uint32_t unknown_0_1: 10;
-   uint32_t stride: 13;
+   uint32_t unknown_0_1: 8;
+   uint32_t stride: 15;
    uint32_t unknown_0_2: 1;
 
    /* Word 1-3 */
-- 
2.23.0

