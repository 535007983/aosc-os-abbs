PKGNAME=systemd
PKGSEC=admin
PKGDEP="glib lz4 xz acl bash cryptsetup curl elfutils gnutls kbd kmod libcap \
        libidn libmicrohttpd libseccomp linux-pam util-linux libgcrypt hwdata \
        libgpg-error iptables libxkbcommon"
BUILDDEP="gperf intltool docbook-xsl lxml gobject-introspection"
[ "$ARCH" = "amd64" ] && BUILDDEP +=" gnu-efi"
PKGDES="System and service manager"

# MicroHTTPD is needed for remote journal.
AUTOTOOLS_AFTER="--localstatedir=/var \
                 --enable-compat-libs \
                 --enable-xz \
                 --enable-lz4 \
                 --enable-hwdb \
                 --disable-gtk-doc \
                 --disable-audit \
                 --disable-ima \
                 --disable-kdbus \
                 --disable-terminal \
                 --disable-qrencode \
                 --enable-libcryptsetup \
                 --enable-seccomp \
                 --enable-microhttpd \
                 --enable-firstboot \
                 --enable-libidn \
                 --disable-kdbus \
                 --enable-ldconfig \
                 --enable-elfutils \
                 --enable-xkbcommon \
                 --enable-libcurl \
                 --enable-gnutls \
                 --with-sysvinit-path= \
                 --with-sysvrcnd-path="
[ "${CROSS:-$ARCH}" = "amd64" ] && AUTOTOOLS_AFTER+=" --enable-gnuefi "

# FIXME: hacks for ARM64/AArch64.
[ "${CROSS:-$ARCH}" = "arm64" ] && ABSTRIP=no
if [ "${CROSS:-$ARCH}" = "arm64" ]; then
	NOLTO=yes
else
	NOLTO=no
fi
PKGBREAK="systemd-sysv<=1"
PKGREP="systemd-sysv<=1"
