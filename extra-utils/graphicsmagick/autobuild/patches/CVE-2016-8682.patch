
# HG changeset patch
# User Bob Friesenhahn <bfriesen@GraphicsMagick.org>
# Date 1473538865 18000
# Node ID 0a0dfa81906d1317895de9374ef5132710c3831c
# Parent  3161d55d0c2f73df109a6d184074f39aca78ae8f
SCT: Fix stack-buffer read overflow while reading file header.

diff -r 3161d55d0c2f -r 0a0dfa81906d ChangeLog
--- a/ChangeLog	Sat Sep 10 13:17:49 2016 -0500
+++ b/ChangeLog	Sat Sep 10 15:21:05 2016 -0500
@@ -6,6 +6,12 @@
 	known (but not fixed) based on comments in the code.  This issue
 	has been assigned CVE-2016-7800.
 
+2016-09-10  Bob Friesenhahn  <bfriesen@simple.dallas.tx.us>
+
+	* coders/sct.c (ReadSCTImage): Fix stack-buffer read overflow
+	while reading SCT header.  Problem was reported via email by
+	Agostino Sarubbo on 2016-09-09.
+
 2016-09-05  Bob Friesenhahn  <bfriesen@simple.dallas.tx.us>
 
 	* www/index.rst: Update for 1.3.25 release.
diff -r 3161d55d0c2f -r 0a0dfa81906d coders/sct.c
--- a/coders/sct.c	Sat Sep 10 13:17:49 2016 -0500
+++ b/coders/sct.c	Sat Sep 10 15:21:05 2016 -0500
@@ -188,9 +188,11 @@
         break;
       if (ReadBlob(image,14,(char *) buffer) != 14)
         break;
+      buffer[14]='\0';
       image->rows=MagickAtoL(buffer) & 0x7FFFFFFF;
       if (ReadBlob(image,14,(char *) buffer) != 14)
         break;
+      buffer[14]='\0';
       image->columns=MagickAtoL(buffer) & 0x7FFFFFFF;
       if (ReadBlob(image,196,(char *) buffer) != 196)
         break;
diff -r 3161d55d0c2f -r 0a0dfa81906d www/Changelog.html
--- a/www/Changelog.html	Sat Sep 10 13:17:49 2016 -0500
+++ b/www/Changelog.html	Sat Sep 10 15:21:05 2016 -0500
@@ -45,6 +45,14 @@ known (but not fixed) based on comments
 has been assigned CVE-2016-7800.</li>
 </ul>
 </blockquote>
+<p>2016-09-10  Bob Friesenhahn  &lt;<a class="reference external" href="mailto:bfriesen&#37;&#52;&#48;simple&#46;dallas&#46;tx&#46;us">bfriesen<span>&#64;</span>simple<span>&#46;</span>dallas<span>&#46;</span>tx<span>&#46;</span>us</a>&gt;</p>
+<blockquote>
+<ul class="simple">
+<li>coders/sct.c (ReadSCTImage): Fix stack-buffer read overflow
+while reading SCT header.  Problem was reported via email by
+Agostino Sarubbo on 2016-09-09.</li>
+</ul>
+</blockquote>
 <p>2016-09-05  Bob Friesenhahn  &lt;<a class="reference external" href="mailto:bfriesen&#37;&#52;&#48;simple&#46;dallas&#46;tx&#46;us">bfriesen<span>&#64;</span>simple<span>&#46;</span>dallas<span>&#46;</span>tx<span>&#46;</span>us</a>&gt;</p>
 <blockquote>
 <ul class="simple">
