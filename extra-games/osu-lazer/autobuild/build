# create necessary folders
mkdir -p "$PKGDIR"/usr/share/osu-lazer

# dotnet aot compiler wants to call clang-3.9, but actually it is compatiable with all versions of clang
# remove patch 0002 and this hunk in case aot breaks
ln -s /usr/bin/clang clang-3.9
export PATH="$(pwd)":$PATH

# restore packages and build in release mode
dotnet restore -r linux-x64
dotnet publish -r linux-x64 -f netcoreapp2.1 -c Release -o "$PKGDIR"/usr/share/osu-lazer/ 

# move binaries to system folder
install -Dm644 "$SRCDIR"/LICENCE "$PKGDIR"/usr/share/doc/$PKGNAME/LICENCE

install -Dm644 "$SRCDIR/osu-resources/osu.Game.Resources/Textures/Menu/logo.png" "$PKGDIR"/usr/share/pixmaps/osu-lazer.png
