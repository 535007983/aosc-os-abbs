From bfb08d5245e48d516f26fe5b070abd01f8de127c Mon Sep 17 00:00:00 2001
From: Victor Toso <victortoso@redhat.com>
Date: Fri, 23 May 2014 15:52:10 +0200
Subject: [PATCH 01/55] build-sys: reformat Makefile.am
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Makes the makefile more readable and easy to change in the next few
commits.

Based on Marc-Andr√© Lureau patch.

Acked-by: Jonathon Jongsma <jjongsma@redhat.com>
Acked-by: Frediano Ziglio <fziglio@redhat.com>
---
 Makefile.am | 98 ++++++++++++++++++++++++++++++++++++++++++-------------------
 1 file changed, 67 insertions(+), 31 deletions(-)

diff --git a/Makefile.am b/Makefile.am
index 680ef83..d27ed13 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -4,24 +4,56 @@ NULL =
 bin_PROGRAMS = src/spice-vdagent
 sbin_PROGRAMS = src/spice-vdagentd
 
-src_spice_vdagent_CFLAGS = $(X_CFLAGS) $(SPICE_CFLAGS) $(GLIB2_CFLAGS) $(ALSA_CFLAGS) -DUDSCS_NO_SERVER
-src_spice_vdagent_LDADD = $(X_LIBS) $(SPICE_LIBS) $(GLIB2_LIBS) $(ALSA_LIBS)
-src_spice_vdagent_SOURCES = src/vdagent.c \
-                            src/vdagent-x11.c \
-                            src/vdagent-x11-randr.c \
-                            src/vdagent-file-xfers.c \
-                            src/vdagent-audio.c \
-                            src/udscs.c
-
-src_spice_vdagentd_CFLAGS = $(DBUS_CFLAGS) $(LIBSYSTEMD_LOGIN_CFLAGS) \
-  $(PCIACCESS_CFLAGS) $(SPICE_CFLAGS) $(GLIB2_CFLAGS) $(PIE_CFLAGS)
-src_spice_vdagentd_LDADD = $(DBUS_LIBS) $(LIBSYSTEMD_LOGIN_LIBS) \
-  $(PCIACCESS_LIBS) $(SPICE_LIBS) $(GLIB2_LIBS) $(PIE_LDFLAGS)
-src_spice_vdagentd_SOURCES = src/vdagentd.c \
-                             src/vdagentd-uinput.c \
-                             src/vdagentd-xorg-conf.c \
-                             src/vdagent-virtio-port.c \
-                             src/udscs.c
+src_spice_vdagent_CFLAGS =			\
+	$(X_CFLAGS)				\
+	$(SPICE_CFLAGS)				\
+	$(GLIB2_CFLAGS)				\
+	$(ALSA_CFLAGS)				\
+	-DUDSCS_NO_SERVER			\
+	$(NULL)
+
+src_spice_vdagent_LDADD =			\
+	$(X_LIBS)				\
+	$(SPICE_LIBS)				\
+	$(GLIB2_LIBS)				\
+	$(ALSA_LIBS)				\
+	$(NULL)
+
+src_spice_vdagent_SOURCES =			\
+	src/udscs.c				\
+	src/vdagent-audio.c			\
+	src/vdagent-file-xfers.c		\
+	src/vdagent-x11-randr.c			\
+	src/vdagent-x11.c			\
+	src/vdagent.c				\
+	$(NULL)
+
+src_spice_vdagentd_CFLAGS =			\
+	$(DBUS_CFLAGS)				\
+	$(LIBSYSTEMD_LOGIN_CFLAGS)		\
+	$(PCIACCESS_CFLAGS)			\
+	$(SPICE_CFLAGS)				\
+	$(GLIB2_CFLAGS)				\
+	$(PIE_CFLAGS)				\
+	$(NULL)
+
+src_spice_vdagentd_LDADD =			\
+	$(DBUS_LIBS)				\
+	$(LIBSYSTEMD_LOGIN_LIBS)		\
+	$(PCIACCESS_LIBS)			\
+	$(SPICE_LIBS)				\
+	$(GLIB2_LIBS)				\
+	$(PIE_LDFLAGS)				\
+	$(NULL)
+
+src_spice_vdagentd_SOURCES =			\
+	src/vdagentd.c				\
+	src/vdagentd-uinput.c			\
+	src/vdagentd-xorg-conf.c		\
+	src/vdagent-virtio-port.c		\
+	src/udscs.c				\
+	$(NULL)
+
 if HAVE_CONSOLE_KIT
 src_spice_vdagentd_SOURCES += src/console-kit.c
 else
@@ -32,17 +64,19 @@ src_spice_vdagentd_SOURCES += src/dummy-session-info.c
 endif
 endif
 
-noinst_HEADERS = src/session-info.h \
-                 src/udscs.h \
-                 src/vdagent-audio.h \
-                 src/vdagent-file-xfers.h \
-                 src/vdagent-virtio-port.h \
-                 src/vdagent-x11.h \
-                 src/vdagent-x11-priv.h \
-                 src/vdagentd-proto.h \
-                 src/vdagentd-proto-strings.h \
-                 src/vdagentd-uinput.h \
-                 src/vdagentd-xorg-conf.h
+noinst_HEADERS =				\
+	src/session-info.h			\
+	src/udscs.h				\
+	src/vdagent-audio.h			\
+	src/vdagent-file-xfers.h		\
+	src/vdagent-virtio-port.h		\
+	src/vdagent-x11-priv.h			\
+	src/vdagent-x11.h			\
+	src/vdagentd-proto-strings.h		\
+	src/vdagentd-proto.h			\
+	src/vdagentd-uinput.h			\
+	src/vdagentd-xorg-conf.h		\
+	$(NULL)
 
 xdgautostartdir = $(sysconfdir)/xdg/autostart
 xdgautostart_DATA = $(top_srcdir)/data/spice-vdagent.desktop
@@ -75,8 +109,10 @@ tmpfiles_DATA = $(top_srcdir)/data/tmpfiles.d/spice-vdagentd.conf
 endif
 
 manpagedir = $(mandir)/man1
-manpage_DATA = data/spice-vdagent.1	\
-               data/spice-vdagentd.1
+manpage_DATA =					\
+	data/spice-vdagent.1			\
+	data/spice-vdagentd.1			\
+	$(NULL)
 
 EXTRA_DIST =					\
 	NEWS					\
-- 
2.16.1

