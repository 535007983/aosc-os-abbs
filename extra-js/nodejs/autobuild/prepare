# From Fedora:
#
# build with debugging symbols and add defines from libuv (#892601)
# Node's v8 breaks with GCC 6 because of incorrect usage of methods on
# NULL objects. We need to pass -fno-delete-null-pointer-checks

export CFLAGS="${CFLAGS}  -g -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -fno-delete-null-pointer-checks"
export CXXFLAGS="${CXXFLAGS}  -g -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -fno-delete-null-pointer-checks"

if [[ "${CROSS:-$ARCH}" = "amd64" ]]; then
  NODEJSARCH="x64"
elif [[ "${CROSS:-$ARCH}" = "arm64" ]]; then
  NODEJSARCH="arm64"
elif [[ "${CROSS:-$ARCH}" = "armel" ]]; then
  NODEJSARCH="arm"
elif [[ "${CROSS:-$ARCH}" = "ppc64el" ]]; then
  NODEJSARCH="ppc64"
else
  aberr "Architecture not supported" && exit 1
fi
abinfo "Architecture is $NODEJSARCH"
