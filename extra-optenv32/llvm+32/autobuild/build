export PATH=/opt/32/bin:$PATH
mkdir build
cd build

../configure \
    --prefix=/opt/32 \
    --build=i686-pc-linux-gnu \
    --host=i686-pc-linux-gnu \
    --target=i686-pc-linux-gnu \
    --sysconfdir=/etc \
    --includedir=/opt/32/include \
    --enable-shared \
    --enable-libffi \
    --enable-targets=all \
    --disable-expensive-checks \
    --disable-debug-runtime \
    --disable-assertions \
    --with-binutils-include=/opt/32/include \
    --without-python \
    --enable-optimized \
    CC=i686-pc-linux-gnu-gcc CXX=i686-pc-linux-gnu-g++ \
    PKG_CONFIG_PATH=/opt/32/lib/pkgconfig 

make REQUIRES_RTTI=1
make install DESTDIR=$PKGDIR

cd $SRCDIR

for file in $PKGDIR/opt/32/lib/lib{clang,LLVM,LTO}*.a; do
    test -f $file && chmod -v 644 $file
done

install -v -dm755 $PKGDIR/opt/32/lib/clang-analyzer
for prog in scan-build scan-view; do
    cp -rfv tools/clang/tools/$prog $PKGDIR/opt/32/lib/clang-analyzer/
    ln -sfv ../lib/clang-analyzer/$prog/$prog $PKGDIR/opt/32/bin/
done

ln -sfv /opt/32/bin/clang $PKGDIR/opt/32/lib/clang-analyzer/scan-build
