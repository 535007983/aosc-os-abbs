echo -e "[\e[96mINFO\e[0m] Downloading AOSC customized Electron version 1.6.15..."
wget -c -q --show-progress "https://repo.aosc.io/aosc-repacks/electron-v1.6.15-linux-x64-aosc.tar.xz"

chmod -R g-w usr

echo -e "[\e[96mINFO\e[0m] Extracting Electron..."
mkdir atom
tar xf "electron-v1.6.15-linux-x64-aosc.tar.xz" -C atom

echo -e "[\e[96mINFO\e[0m] Moving files in place..."
cp -ar usr/share/atom/resources atom/
rm -rf usr/share/atom

mkdir -p "$PKGDIR"
cp -ar usr "$PKGDIR"/
mv atom "$PKGDIR"/usr/share/
mv "$PKGDIR"/usr/share/atom/electron "$PKGDIR"/usr/share/atom/atom
# Merging apm and atom, for atom still uses bundled apm
# rm "$PKGDIR"/usr/bin/apm
# rm "$PKGDIR"/usr/share/atom/resources/app/apm/node_modules/.bin/apm
# ln -sv /usr/bin/apm "$PKGDIR"/usr/share/atom/resources/app/apm/node_modules/.bin/apm

rm -r "$PKGDIR"/usr/share/lintian
