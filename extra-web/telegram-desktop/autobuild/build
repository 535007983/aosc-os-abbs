abinfo "Building Telegram..."
cmake . ${CMAKE_DEF} ${CMAKE_AFTER}
make

abinfo "Installing Telegram binary..."
install -dvm0755 "$PKGDIR"/usr/bin
install -vm0755 "$SRCDIR"/bin/Telegram \
    "$PKGDIR"/usr/bin/telegram-desktop

abinfo "Installing icons..."
for icon_size in 16 32 48 64 128 256 512; do
    icon_dir="$PKGDIR"/usr/share/icons/hicolor/${icon_size}x${icon_size}/apps
    install -dvm0755 "$icon_dir"
    install -vm0644 "$SRCDIR"/Telegram/Resources/art/icon${icon_size}.png \
        "$icon_dir"/telegram-desktop.png
done

abinfo "Installing XDG data files..."
install -Dvm0644 "$SRCDIR"/lib/xdg/telegramdesktop.desktop \
    "$PKGDIR"/usr/share/applications/telegramdesktop.desktop
install -Dvm0644 "$SRCDIR"/lib/xdg/telegramdesktop.appdata.xml \
    "$PKGDIR"/usr/share/appdata/telegramdesktop.appdata.xml
install -Dvm0644 "$SRCDIR"/lib/xdg/tg.protocol \
    "$PKGDIR"/usr/share/kservices5/tg.protocol
